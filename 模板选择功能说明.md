# RT结果通知台账模板选择功能说明

## 功能概述

在GUI界面的"RT结果通知台账"功能模块中成功添加了模板选择功能，用户可以在"模板1"和"模板2"之间进行选择，不同模板对应不同的处理脚本和参数要求。

## 功能实现

### 1. 模板选择下拉框
- 位置：参数设置区域的第一行
- 选项：模板1、模板2
- 默认值：模板2
- 状态：只读（readonly）

### 2. 动态参数显示
根据选择的模板，参数输入框会动态显示或隐藏：

#### 模板1参数（5个）：
- ✅ 工程名称
- ✅ 委托单位  
- ✅ 检测方法
- ✅ 检测单位（模板1专用）
- ✅ 检测标准（模板1专用）

#### 模板2参数（3个）：
- ✅ 工程名称
- ✅ 委托单位
- ✅ 检测方法

### 3. 脚本调用逻辑

#### 模板1选择时：
- 调用脚本：`NDT_result_mode1.py`
- 传参函数：`NDT_result_mode1.process_excel_to_word()`
- 参数顺序：
  1. excel_path（Excel文件路径）
  2. word_template_path（Word模板路径）
  3. output_path（输出路径）
  4. project_name（工程名称）
  5. client_name（委托单位）
  6. inspection_unit（检测单位）
  7. inspection_standard（检测标准）
  8. inspection_method（检测方法）

#### 模板2选择时：
- 调用脚本：`NDT_result.py`
- 传参函数：`NDT_result.process_excel_to_word()`
- 参数顺序：
  1. excel_path（Excel文件路径）
  2. word_template_path（Word模板路径）
  3. output_path（输出路径）
  4. project_name（工程名称）
  5. client_name（委托单位）
  6. inspection_method（检测方法）

## 代码实现细节

### 1. GUI组件添加
```python
# 模板选择下拉框
template_label = ttk.Label(row0_frame, text="模板")
self.template_var = tk.StringVar()
self.template_combobox = ttk.Combobox(row0_frame, textvariable=self.template_var, 
                                    values=["模板1", "模板2"], state="readonly")
self.template_combobox.set("模板2")  # 默认选择模板2
self.template_combobox.bind("<<ComboboxSelected>>", self.on_template_change)

# 模板1专用参数框架（初始隐藏）
self.row3_frame = ttk.Frame(params_grid)
# 检测单位和检测标准输入框
```

### 2. 模板切换回调函数
```python
def on_template_change(self, event=None):
    """模板选择变化时的回调函数"""
    selected_template = self.template_var.get()
    
    if selected_template == "模板1":
        # 显示模板1专用参数
        self.row3_frame.pack(fill=tk.X, pady=5)
    else:
        # 隐藏模板1专用参数
        self.row3_frame.pack_forget()
```

### 3. 处理逻辑修改
```python
def process_data(self):
    # 获取模板选择
    selected_template = self.template_var.get()
    
    # 根据模板选择调用不同的处理函数
    if selected_template == "模板1":
        threading.Thread(target=self.run_process_mode1, args=(...)).start()
    else:
        threading.Thread(target=self.run_process, args=(...)).start()
```

## 使用说明

### 操作步骤：
1. 打开GUI应用程序
2. 选择"RT结果通知台账"功能模块
3. 在参数设置区域选择所需的模板：
   - 选择"模板1"：显示所有5个参数输入框
   - 选择"模板2"：只显示3个基础参数输入框
4. 填写相应的参数值
5. 选择Excel文件、Word模板文件和输出文件夹
6. 点击"提交"按钮执行处理

### 注意事项：
- 模板选择会影响参数显示和脚本调用
- 模板1需要填写更多参数（检测单位、检测标准）
- 模板2使用简化的参数集
- 切换模板时，专用参数会自动显示或隐藏
- 默认选择模板2以保持向后兼容性

## 测试验证

已创建测试脚本 `test_gui_template.py` 用于验证模板选择功能的正确性。测试包括：
- 模板切换的UI响应
- 参数框的显示/隐藏逻辑
- 事件绑定的正确性

## 技术实现

### 文件修改：
- ✅ `gui.py`：添加模板选择功能
- ✅ 导入 `NDT_result_mode1` 模块
- ✅ 添加动态参数显示逻辑
- ✅ 修改数据处理流程

### 新增方法：
- ✅ `on_template_change()`：模板切换回调
- ✅ `run_process_mode1()`：模板1数据处理

### 兼容性：
- ✅ 保持原有模板2功能不变
- ✅ 默认选择模板2确保向后兼容
- ✅ 不影响其他功能模块

## 功能状态

🎉 **功能实现完成！**

所有需求已成功实现：
- ✅ 模板下拉选择框已添加
- ✅ 动态参数显示已实现
- ✅ 模板1和模板2的脚本调用已配置
- ✅ 参数传递逻辑已完善
- ✅ GUI界面已更新
- ✅ 功能测试已通过
