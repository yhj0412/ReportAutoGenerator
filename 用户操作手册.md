# NDT结果生成器用户操作手册

## 📋 文档信息

- **软件名称**: NDT结果生成器 (NDT Result Generator)
- **软件版本**: v1.0
- **手册版本**: v1.0
- **编写日期**: 2024-06-24
- **适用用户**: 无损检测技术人员、质量管理人员

---

## 🚀 快速开始

### 第一步：启动程序
1. 双击桌面上的 `NDT结果生成器.exe` 或 `启动NDT结果生成器.bat`
2. 等待程序加载完成（首次启动可能需要几秒钟）
3. 看到主界面后即可开始使用

### 第二步：选择功能模块
在左侧导航栏中选择需要的功能：
- **射线检测委托台账** - 生成射线检测委托台账报告
- **RT结果通知单台账** - 生成RT检测结果通知单
- **表面结果通知单台账** - 生成表面检测结果通知单
- **射线检测记录** - 生成射线检测记录表
- **射线检测记录续** - 生成射线检测记录续表

### 第三步：配置参数和文件
1. 选择模板模式（Mode1或Mode2）
2. 填写必要的业务参数
3. 选择输入Excel文件
4. 选择Word模板文件
5. 设置输出目录

### 第四步：生成报告
1. 点击"提交"按钮
2. 观察日志区域的处理进度
3. 等待处理完成提示
4. 到输出目录查看生成的报告

---

## 📖 详细操作指南

## 1. 射线检测委托台账

### 1.1 功能说明
将Excel委托台账数据自动填入射线检测委托台账Word模板，支持按委托单编号分组生成多份报告。

### 1.2 操作步骤

#### 步骤1：选择模板模式
- **模板1 (Mode1)**: 需要8个参数，适用于详细的委托台账
- **模板2 (Mode2)**: 需要5个参数，适用于简化的委托台账

#### 步骤2：填写参数

**模板1参数**：
- **工程名称**: 项目工程的名称
- **委托单位**: 委托检测的单位名称
- **检测标准**: 执行的检测标准
- **验收规范**: 验收依据的规范
- **检测方法**: 使用的检测方法
- **检测技术等级**: 检测技术等级要求
- **外观检查**: 外观检查要求
- **坡口形式**: 焊接坡口形式

**模板2参数**：
- **工程名称**: 项目工程的名称
- **检测类别号**: 检测类别编号
- **检测标准**: 执行的检测标准
- **检测方法**: 使用的检测方法
- **坡口形式**: 焊接坡口形式

#### 步骤3：选择文件
- **Excel文件**: 选择包含委托台账数据的Excel文件
  - 默认路径：`生成器/Excel/1_生成器委托.xlsx`
- **Word模板**: 根据选择的模板模式自动设置
  - Mode1：`生成器/word/1_射线检测委托台账_Mode1.docx`
  - Mode2：`生成器/word/1_射线检测委托台账_Mode2.docx`
- **输出路径**: 设置生成报告的保存目录

#### 步骤4：提交处理
1. 确认所有参数已正确填写
2. 点击"提交"按钮
3. 观察日志区域显示的处理进度
4. 等待"处理完成"提示

### 1.3 Excel数据要求

Excel文件应包含以下列：
- **A列**: 委托日期
- **C列**: 委托单编号（用于分组）
- **D列**: 检件编号
- **E列**: 焊口编号
- **F列**: 焊工号
- **G列**: 规格
- **H列**: 材质
- **I列**: 合格级别
- **J列**: 检测比例
- **其他列**: 根据需要包含备注、单元名称等信息

### 1.4 输出结果
- 按委托单编号分组，每个委托单编号生成一个独立的Word文档
- 文件命名格式：`委托单编号_射线检测委托台账.docx`
- 所有生成的文件保存在指定的输出目录中

## 2. RT结果通知单台账

### 2.1 功能说明
处理射线检测结果数据，生成RT结果通知单台账。支持检测方法与检测级别值的智能映射。

### 2.2 操作步骤

#### 步骤1：选择模板模式
- **模板1 (Mode1)**: 需要5个参数，包含检测单位和检测标准
- **模板2 (Mode2)**: 需要3个参数，简化版本

#### 步骤2：填写参数

**模板1参数**：
- **工程名称**: 项目工程的名称
- **委托单位**: 委托检测的单位名称
- **检测单位**: 执行检测的单位名称
- **检测方法**: 使用的检测方法（支持智能映射）
- **检测标准**: 执行的检测标准

**模板2参数**：
- **工程名称**: 项目工程的名称
- **委托单位**: 委托检测的单位名称
- **检测方法**: 使用的检测方法（支持智能映射）

#### 步骤3：检测级别值智能映射
系统会根据填写的检测方法自动确定检测级别值：

| 检测方法 | 自动映射的检测级别值 |
|---------|-------------------|
| 硬度检测 或 YD | 力学   级 |
| 光谱检测 或 PMIN | 光谱分析  级 |
| UT | UT  级 |
| PT | PT  级 |
| MT | MT  级 |
| RT | RT  级 |
| TOFD | TOFD  级 |
| PA | PA  级 |

#### 步骤4：选择文件和处理
- **Excel文件**: 选择包含RT结果数据的Excel文件
- **Word模板**: 根据模板模式自动设置
- **输出路径**: 设置输出目录
- 点击"提交"开始处理

### 2.3 Excel数据要求

Excel文件应包含以下列：
- **B列**: 完成日期
- **C列**: 委托单编号（用于分组）
- **D列**: 检件编号
- **E列**: 焊口编号
- **F列**: 焊工号
- **K列**: 返修补片（检测结果）
- **N列**: 检测方法（用于智能映射）
- **O列**: 备注
- **Q列**: 单元名称
- **W列**: 实际不合格数量

## 3. 表面结果通知单台账

### 3.1 功能说明
处理表面检测结果数据，生成表面结果通知单台账。同样支持检测方法与检测级别值的智能映射。

### 3.2 操作步骤

#### 步骤1：选择模板模式
- **模板1 (Mode1)**: 需要4个参数，读取Excel的sheet3工作表
- **模板2 (Mode2)**: 需要2个参数，简化版本

#### 步骤2：填写参数

**模板1参数**：
- **工程名称**: 项目工程的名称
- **委托单位**: 委托检测的单位名称
- **检测单位**: 执行检测的单位名称
- **检测标准**: 执行的检测标准

**模板2参数**：
- **工程名称**: 项目工程的名称
- **委托单位**: 委托检测的单位名称

#### 步骤3：选择文件和处理
- **Excel文件**: 选择包含表面检测数据的Excel文件
  - 默认路径：`生成器/Excel/3_生成器表面结果.xlsx`
  - 数据来源：Excel的第3个工作表（sheet3）"荣信聚乙烯PT"
- **Word模板**: 根据模板模式自动设置
- **输出路径**: 设置输出目录
- 点击"提交"开始处理

### 3.3 特殊说明
- 表面结果通知单台账同样支持检测级别值智能映射
- Mode1和Mode2的数据映射规则略有不同
- 系统会自动处理空值，如返修张数为空时自动填写"0"

## 4. 射线检测记录

### 4.1 功能说明
生成射线检测记录表，记录详细的检测过程和结果。

### 4.2 操作步骤
1. 选择"射线检测记录"模块
2. 填写必要的参数（具体参数根据模板要求）
3. 选择对应的Excel数据文件和Word模板
4. 设置输出目录
5. 点击"提交"处理

## 5. 射线检测记录续

### 5.1 功能说明
生成射线检测记录续表，用于记录额外的检测信息。

### 5.2 操作步骤
1. 选择"射线检测记录续"模块
2. 填写必要的参数
3. 选择对应的Excel数据文件和Word模板
4. 设置输出目录
5. 点击"提交"处理

---

## ⚠️ 注意事项

### 文件格式要求
- **Excel文件**: 必须是.xlsx格式
- **Word模板**: 必须是.docx格式
- **文件路径**: 支持中文路径和文件名

### 数据要求
- Excel文件必须包含必要的列
- 委托单编号不能为空（用于分组）
- 日期格式应为标准的Excel日期格式

### 权限要求
- 确保对输出目录有写入权限
- 确保Excel和Word文件没有被其他程序占用
- 首次运行可能需要添加杀毒软件白名单

### 性能建议
- 单次处理建议不超过1000条记录
- 大量数据建议分批处理
- 处理过程中不要关闭程序

---

## 🔧 故障排除

### 常见问题

#### 1. 程序无法启动
**问题**: 双击exe文件没有反应
**解决方案**:
- 检查是否被杀毒软件拦截，添加到白名单
- 尝试以管理员身份运行
- 确保系统满足最低要求（Windows 7+）

#### 2. 找不到模板文件
**问题**: 提示"找不到Word模板文件"
**解决方案**:
- 确保"生成器"文件夹与exe文件在同一目录
- 检查模板文件是否存在且路径正确
- 重新下载完整的安装包

#### 3. Excel文件读取失败
**问题**: 提示"Excel文件读取失败"
**解决方案**:
- 确保Excel文件格式为.xlsx
- 检查文件是否被其他程序打开
- 验证文件路径是否正确
- 确保文件包含必要的数据列

#### 4. 生成的Word文档格式异常
**问题**: 生成的文档格式不正确
**解决方案**:
- 检查Word模板文件是否完整
- 确保使用正确的模板模式
- 验证Excel数据格式是否符合要求

#### 5. 处理速度慢
**问题**: 处理大量数据时速度很慢
**解决方案**:
- 建议单次处理不超过1000条记录
- 关闭其他不必要的程序释放内存
- 将数据分批处理

### 错误代码说明

| 错误代码 | 错误描述 | 解决方案 |
|---------|---------|---------|
| E001 | Excel文件不存在 | 检查文件路径 |
| E002 | Word模板不存在 | 检查模板路径 |
| E003 | 输出目录无权限 | 更改输出目录或获取权限 |
| E004 | 数据格式错误 | 检查Excel数据格式 |
| E005 | 内存不足 | 减少数据量或重启程序 |

---

## 📞 技术支持

如果遇到本手册未涵盖的问题，请：

1. **查看日志信息**: 程序界面右下角的日志区域会显示详细的错误信息
2. **截图保存**: 保存错误截图和相关的输入文件
3. **联系技术支持**: 提供详细的问题描述和错误信息

**技术支持信息**:
- 软件版本: v1.0
- 构建日期: 2024-06-24
- 支持系统: Windows 7/8/10/11

---

**手册版本**: v1.0  
**最后更新**: 2024-06-24  
**文档状态**: 正式版
